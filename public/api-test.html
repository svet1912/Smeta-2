<!DOCTYPE html>
<html>
<head>
    <title>API Test</title>
</head>
<body>
    <h1>API Test –¥–ª—è –ü–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –û–±—ä–µ–∫—Ç–∞</h1>
    <div id="results"></div>
    
    <script>
        const results = document.getElementById('results');
        
        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ API URL
        const getApiBaseUrl = () => {
            // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –¥–ª—è GitHub Codespaces
            const currentHost = window.location.hostname;
            console.log('üîß Current hostname:', currentHost);
            
            if (currentHost.includes('.app.github.dev')) {
                console.log('üîß GitHub Codespaces detected, using /api-proxy');
                return '/api-proxy';
            }
            
            console.log('üîß Local development, using direct API URL');
            return 'http://localhost:3001/api';
        };
        
        async function testAPI() {
            const apiBaseUrl = getApiBaseUrl();
            console.log('üîß API Base URL:', apiBaseUrl);
            
            // –¢–µ—Å—Ç —Ç–æ–∫–µ–Ω–∞
            const token = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySWQiOjYsImVtYWlsIjoia2l5MDI2QHlhbmRleC5ydSIsImZpcnN0bmFtZSI6ItCY0LvRjNGPIiwibGFzdG5hbWUiOiLQmtGD0LfRjNC80LjQvSIsInJvbGUiOiJzdXBlcl9hZG1pbiIsInRlbmFudElkIjoiY2Q1ZmZiMGYtODYxNi00MjI3LWEwNTYtNGY3MjllZDY5MzNjIiwiaWF0IjoxNzU5NzM1MjA1LCJleHAiOjE3NTk4MjE2MDV9.oHO_xou0LFkBRmXW0uYWLZJjJ0uDeWlHxEghHxlY7i4';
            
            try {
                // –¢–µ—Å—Ç 1: –ó–∞–≥—Ä—É–∑–∫–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –æ–±—ä–µ–∫—Ç–∞
                console.log('üì§ –¢–µ—Å—Ç 1: –ó–∞–≥—Ä—É–∑–∫–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –æ–±—ä–µ–∫—Ç–∞');
                const response1 = await fetch(`${apiBaseUrl}/projects/56/object-parameters`, {
                    headers: {
                        'Authorization': `Bearer ${token}`,
                        'Content-Type': 'application/json'
                    }
                });
                
                console.log('üì° –û—Ç–≤–µ—Ç 1 —Å—Ç–∞—Ç—É—Å:', response1.status);
                if (response1.ok) {
                    const data1 = await response1.json();
                    console.log('‚úÖ –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –æ–±—ä–µ–∫—Ç–∞ –∑–∞–≥—Ä—É–∂–µ–Ω—ã:', data1);
                    results.innerHTML += '<p>‚úÖ –¢–µ—Å—Ç 1: –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –æ–±—ä–µ–∫—Ç–∞ –∑–∞–≥—Ä—É–∂–µ–Ω—ã</p>';
                } else {
                    console.log('‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤:', response1.status);
                    results.innerHTML += '<p>‚ùå –¢–µ—Å—Ç 1: –û—à–∏–±–∫–∞ ' + response1.status + '</p>';
                }
                
                // –¢–µ—Å—Ç 2: –ó–∞–≥—Ä—É–∑–∫–∞ –ø–æ–º–µ—â–µ–Ω–∏–π
                console.log('üì§ –¢–µ—Å—Ç 2: –ó–∞–≥—Ä—É–∑–∫–∞ –ø–æ–º–µ—â–µ–Ω–∏–π');
                const response2 = await fetch(`${apiBaseUrl}/object-parameters/29/rooms`, {
                    headers: {
                        'Authorization': `Bearer ${token}`,
                        'Content-Type': 'application/json'
                    }
                });
                
                console.log('üì° –û—Ç–≤–µ—Ç 2 —Å—Ç–∞—Ç—É—Å:', response2.status);
                if (response2.ok) {
                    const data2 = await response2.json();
                    console.log('‚úÖ –ü–æ–º–µ—â–µ–Ω–∏—è –∑–∞–≥—Ä—É–∂–µ–Ω—ã:', data2);
                    results.innerHTML += '<p>‚úÖ –¢–µ—Å—Ç 2: –ü–æ–º–µ—â–µ–Ω–∏—è –∑–∞–≥—Ä—É–∂–µ–Ω—ã (' + data2.length + ' —à—Ç.)</p>';
                } else {
                    console.log('‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –ø–æ–º–µ—â–µ–Ω–∏–π:', response2.status);
                    results.innerHTML += '<p>‚ùå –¢–µ—Å—Ç 2: –û—à–∏–±–∫–∞ ' + response2.status + '</p>';
                }
                
            } catch (error) {
                console.error('‚ùå –û—à–∏–±–∫–∞ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:', error);
                results.innerHTML += '<p>‚ùå –û—à–∏–±–∫–∞: ' + error.message + '</p>';
            }
        }
        
        // –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤
        testAPI();
    </script>
</body>
</html>